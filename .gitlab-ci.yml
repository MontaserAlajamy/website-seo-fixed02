stages:
  - build
  - test
  - deploy

build:
  stage: build
  script:
    - echo "Building application..."
    - npm install
    - npm run build
  artifacts:
    paths:
      - dist/
    expire_in: 1 hour
  only:
    - main

test:
  stage: test
  script:
    - echo "Running linting..."
    - npm run lint
  only:
    - main
    - merge_requests

deploy-prod:
  stage: deploy
  script:
    - echo "Deploying to Cloudflare Pages..."
    - npm install -g wrangler
    - wrangler pages deploy dist --project-name=website-seo-fixed02 --commit-dirty=true
  only:
    - main
  when: manual
  environment:
    name: production
    url: https://muntasirelagami.com
